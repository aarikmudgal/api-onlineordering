@mixin Modal {
  $modal-transition-duration: 210ms;

  .m-modal {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;

    display: block;
    white-space: normal;
    vertical-align: middle;
    text-align: center;

    overflow: hidden;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;

    max-height: 100%;
    width: 100%;

    background-color: transparentize(color-tint(metro-blue, 40), 0.9);

    &:before {
      display: inline-block;
      overflow: hidden;
      width: 0;
      height: 100%;
      vertical-align: middle;
      content: "";
    }

    &-enter {
      will-change: background-color;
      animation: $modal-transition-duration modal-bg-fade-in;

      .m-modal-panel {
        will-change: transform, opacity;
        animation: $modal-transition-duration modal-panel-fade-in;
      }

      @at-root {
        @keyframes modal-bg-fade-in {
          from {
            background-color: transparentize(color-tint(metro-blue, 40), 1);
          }
          to {
            background-color: transparentize(color-tint(metro-blue, 40), 0.9);
          }
        }

        @keyframes modal-panel-fade-in {
          from {
            transform: translateY(2%) scale(0.95);
            opacity: 0;
          }
          to {
            transform: translateY(0%) scale(1);
            opacity: 1;
          }
        }
      }
    }

    &-exit {
      will-change: background-color;
      animation: $modal-transition-duration modal-bg-fade-out both;

      .m-modal-panel {
        will-change: transform, opacity;
        animation: $modal-transition-duration modal-panel-fade-out;
      }

      @at-root {
        @keyframes modal-bg-fade-out {
          from {
            background-color: transparentize(color-tint(metro-blue, 40), 0.9);
          }
          to {
            background-color: transparentize(color-tint(metro-blue, 40), 1);
          }
        }

        @keyframes modal-panel-fade-out {
          from {
            transform: translateY(0%) scale(1);
            opacity: 1;
          }
          to {
            transform: translateY(2%) scale(0.95);
            opacity: 0;
          }
        }
      }
    }

    &.m-modal-compact {
      .m-modal-panel {
        max-width: 505px;
      }

      .m-modal-content {
        text-align: center;

        @media (min-width: map-get($breakpoints, "small")) {
          padding: 15px 0 0;
        }
      }
    }

    &.m-modal-bottom {
      .m-modal-panel {
        max-width: none;
        width: 100%;
        border-radius: 0;
        box-shadow: none;
        vertical-align: bottom;
      }

      &.m-modal-enter {
        -webkit-backface-visibility: hidden;
        overflow: hidden;

        &.m-modal-enter-active {
          .m-modal-panel {
            animation: $modal-transition-duration m-modal-panel-slide-in;
          }
        }
      }

      &.m-modal-exit {

        overflow: hidden;

        .m-modal-panel {
          animation: $modal-transition-duration m-modal-panel-slide-in reverse;
          will-change: transform;
        }

      }

      @at-root {
        @keyframes m-modal-panel-slide-in {
          0% {
            transform: translateY(100%);
          }
          100% {
            transform: translateY(0%);
          }
        }
      }
    }

    /* Specificy set to ensure override from .panel */
    .m-modal-panel {
      position: relative;
      display: inline-flex;
      flex-direction: column;

      white-space: normal;
      vertical-align: middle;
      text-align: center;

      border-radius: 0;
      background-color: transparent;
      box-shadow: none;

      max-width: 677px;
      width: 100%;
    }

    &-card {
      @include has-box-shadow-3;

      border-radius: 3px;
      background-color: white;
    }

    &-contentBelow {
      margin: px2rem(14) 0;
    }

    &-content {
      text-align: left;
    }

    &-header {
      font-size: 20px;
      text-align: left;
    }

    &-footer {
      display: flex;
      justify-content: flex-end;
      margin-top: 0;

      &-isSpread {
        justify-content: space-between;
      }
    }

    &-close {
      position: absolute;
      right: 0;
      top: 0;

      display: flex;
      align-items: center;

      height: px2rem(64);
      padding: 0 px2rem(16);
      color: color(metro-blue);

      float: right;
      font-size: px2rem(16);
      line-height: 0;

      .m-modal-compact & {
        height: px2rem(64);
        padding: 0 px2rem(16);
        font-size: px2rem(22);

        @media (min-width: map-get($breakpoints, 'medium')) {
          padding: 0 px2rem(24);
        }
      }
    }
  }

  .m-modalContainer {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 100%;

    display: block;

    text-align: center;

    pointer-events: none;

    overflow: hidden;
    z-index: -1;

    transition: 0s bottom, 0s height, 0s z-index;
    transition-delay: 200ms, 200ms, 200ms;

    &-active {
      bottom: 0;

      z-index: zIndex(modal);
      transition-delay: 0s, 0s, 0s;
      pointer-events: auto;
    }
  }
}
